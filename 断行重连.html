<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>断行重连（删除换行）</title>
  <style>
    :root{
      --bg0:#f7f8fb;
      --bg1:#f2f6ff;
      --card:#ffffffcc;
      --border:rgba(15, 23, 42, 0.08);
      --shadow: 0 10px 30px rgba(15, 23, 42, 0.06);
      --shadow-hover: 0 12px 34px rgba(15, 23, 42, 0.08);
      --text:#223046;
      --muted:#5b6b82;
      --hint:#8aa0bf;
      --focus:rgba(80, 120, 255, 0.25);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --radius: 16px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(196, 226, 255, 0.35), transparent 60%),
        radial-gradient(1000px 700px at 80% 0%, rgba(255, 210, 235, 0.25), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
    }

    .wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 28px 18px 36px;
    }

    header{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 16px;
      margin-bottom: 18px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap: 6px;
    }

    h1{
      margin:0;
      font-size: 18px;
      letter-spacing: 0.2px;
      font-weight: 650;
      color: #1b2a40;
    }

    .subtitle{
      margin:0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
      max-width: 820px;
    }

    .toolbar{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }

    .btn{
      appearance:none;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.65);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 13px;
      line-height: 1;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.04);
      transition: background 140ms ease, box-shadow 140ms ease, transform 140ms ease, border-color 140ms ease;
      user-select:none;
    }
    .btn:hover{
      background: rgba(255,255,255,0.78);
      box-shadow: 0 8px 22px rgba(15, 23, 42, 0.06);
    }
    .btn:active{ transform: translateY(1px); }
    .btn:focus-visible{
      outline:none;
      box-shadow: 0 0 0 4px var(--focus), 0 8px 22px rgba(15, 23, 42, 0.06);
    }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      overflow:hidden;
      transition: box-shadow 180ms ease;
    }
    .card:hover{ box-shadow: var(--shadow-hover); }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }

    .panel{
      padding: 14px 14px 12px;
      display:flex;
      flex-direction:column;
      min-height: 62vh;
    }

    .panel-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .panel-title{
      font-size: 13px;
      font-weight: 650;
      letter-spacing: 0.2px;
      color: #1f2f46;
      display:flex;
      align-items:center;
      gap: 8px;
    }

    .badge{
      font-size: 12px;
      color: var(--hint);
      background: rgba(120, 160, 210, 0.10);
      border: 1px solid rgba(120, 160, 210, 0.18);
      padding: 3px 8px;
      border-radius: 999px;
      font-weight: 600;
    }

    textarea{
      width:100%;
      flex:1;
      resize: none;
      border-radius: 14px;
      border: 1px solid rgba(15, 23, 42, 0.10);
      background: rgba(255,255,255,0.72);
      padding: 12px 12px;
      font-family: var(--mono);
      font-size: 13px;
      line-height: 1.55;
      color: #1f2f46;
      transition: border-color 140ms ease, box-shadow 140ms ease, background 140ms ease;
      outline:none;
    }
    textarea::placeholder{ color: rgba(60, 80, 110, 0.55); }
    textarea:focus{
      border-color: rgba(80, 120, 255, 0.35);
      box-shadow: 0 0 0 4px var(--focus);
      background: rgba(255,255,255,0.85);
    }

    .meta{
      margin-top: 10px;
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.4;
    }
    .meta strong{
      font-weight: 650;
      color:#2a3c56;
    }

    .switch{
      display:flex;
      align-items:center;
      gap: 10px;
      color: var(--muted);
      font-size: 12px;
      user-select:none;
    }
    .toggle{
      width: 40px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.65);
      position:relative;
      cursor:pointer;
      transition: background 140ms ease, border-color 140ms ease, box-shadow 140ms ease;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.04);
    }
    .toggle:focus-visible{
      outline:none;
      box-shadow: 0 0 0 4px var(--focus), 0 6px 18px rgba(15, 23, 42, 0.04);
    }
    .knob{
      position:absolute;
      top: 3px;
      left: 3px;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: rgba(40, 60, 90, 0.55);
      transition: transform 140ms ease, background 140ms ease;
    }
    .toggle.on{
      background: rgba(140, 190, 255, 0.18);
      border-color: rgba(140, 190, 255, 0.35);
    }
    .toggle.on .knob{
      transform: translateX(16px);
      background: rgba(45, 85, 165, 0.75);
    }

    @media (max-width: 960px){
      .grid{ grid-template-columns: 1fr; }
      .panel{ min-height: 44vh; }
      header{ flex-direction:column; align-items:flex-start; }
      .toolbar{ justify-content:flex-start; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>断行重连工具</h1>
        <p class="subtitle">
          左侧输入文本，右侧自动输出“删除所有换行符”的结果（支持 Windows / macOS / Linux 换行）。
          界面采用低对比、浅色雾面卡片风格，适合长时间使用。
        </p>
      </div>

      <div class="toolbar">
        <button class="btn" id="btnCopy" type="button">复制结果</button>
        <button class="btn" id="btnClear" type="button">清空</button>
      </div>
    </header>

    <div class="grid">
      <section class="card panel">
        <div class="panel-head">
          <div class="panel-title">输入 <span class="badge" id="inBadge">0 字符</span></div>
          <label class="switch" title="开启后会把多行连续空行也一并删除（即所有换行）。关闭也同样会删除所有换行；此开关仅用于“可见提示”，便于扩展。">
            <span>删除换行</span>
            <button class="toggle on" id="toggleRemove" type="button" aria-pressed="true">
              <span class="knob" aria-hidden="true"></span>
            </button>
          </label>
        </div>

        <textarea id="input"
          placeholder="把需要重连的文本粘贴到这里&#10;右侧会自动把换行符全部删除"
          spellcheck="false"></textarea>

        <div class="meta">
          <div>换行检测：<strong id="nlInfo">—</strong></div>
          <div>提示：<strong>右侧为实时结果</strong></div>
        </div>
      </section>

      <section class="card panel">
        <div class="panel-head">
          <div class="panel-title">结果 <span class="badge" id="outBadge">0 字符</span></div>
          <div class="switch">
            <span>只读</span>
            <span class="badge">自动更新</span>
          </div>
        </div>

        <textarea id="output" readonly spellcheck="false"
          placeholder="这里显示删除换行后的结果"></textarea>

        <div class="meta">
          <div>已删除换行：<strong id="removedCount">0</strong></div>
          <div>复制：<strong>右上角「复制结果」</strong></div>
        </div>
      </section>
    </div>
  </div>

  <script>
    (function () {
      const elIn = document.getElementById('input');
      const elOut = document.getElementById('output');
      const inBadge = document.getElementById('inBadge');
      const outBadge = document.getElementById('outBadge');
      const nlInfo = document.getElementById('nlInfo');
      const removedCount = document.getElementById('removedCount');

      const btnCopy = document.getElementById('btnCopy');
      const btnClear = document.getElementById('btnClear');

      const toggleRemove = document.getElementById('toggleRemove');
      let removeEnabled = true; // 当前需求：始终删除所有换行；保留开关用于未来扩展/视觉提示

      function countNewlines(s) {
        // 统计各种换行符：\r\n / \n / \r
        // 为避免重复计数：先数 \r\n，再分别数剩余的 \n 和 \r
        const crlf = (s.match(/\r\n/g) || []).length;
        const withoutCrlf = s.replace(/\r\n/g, '');
        const lf = (withoutCrlf.match(/\n/g) || []).length;
        const cr = (withoutCrlf.match(/\r/g) || []).length;
        return { crlf, lf, cr, total: crlf + lf + cr };
      }

      function detectNewlineType(info) {
        if (info.total === 0) return '无';
        const parts = [];
        if (info.crlf) parts.push(`CRLF(\\r\\n)×${info.crlf}`);
        if (info.lf) parts.push(`LF(\\n)×${info.lf}`);
        if (info.cr) parts.push(`CR(\\r)×${info.cr}`);
        return parts.join('，');
      }

      function transform(input) {
        // 需求：删除所有换行符（包含 \r\n \n \r）
        // 如未来希望“只删除单换行但保留段落”，可在此扩展规则。
        const nl = countNewlines(input);
        const output = input.replace(/\r\n|\n|\r/g, '');
        return { output, removed: nl.total, nl };
      }

      function refresh() {
        const raw = elIn.value || '';
        const { output, removed, nl } = transform(raw);

        elOut.value = output;

        inBadge.textContent = `${raw.length} 字符`;
        outBadge.textContent = `${output.length} 字符`;
        removedCount.textContent = String(removed);
        nlInfo.textContent = detectNewlineType(nl);
      }

      // 事件：实时更新
      elIn.addEventListener('input', refresh);

      // 复制结果
      btnCopy.addEventListener('click', async () => {
        const text = elOut.value || '';
        try {
          await navigator.clipboard.writeText(text);
          btnCopy.textContent = '已复制';
          setTimeout(() => (btnCopy.textContent = '复制结果'), 900);
        } catch {
          // 兼容：部分环境不允许 clipboard API，使用选择+提示
          elOut.focus();
          elOut.select();
          document.execCommand('copy');
          btnCopy.textContent = '已复制';
          setTimeout(() => (btnCopy.textContent = '复制结果'), 900);
        }
      });

      // 清空
      btnClear.addEventListener('click', () => {
        elIn.value = '';
        refresh();
        elIn.focus();
      });

      // 开关（当前仍保持删除换行；开关仅改变视觉状态与 aria）
      toggleRemove.addEventListener('click', () => {
        removeEnabled = !removeEnabled;
        toggleRemove.classList.toggle('on', removeEnabled);
        toggleRemove.setAttribute('aria-pressed', String(removeEnabled));
        // 当前版本：无论开关状态，都执行“删除所有换行”以满足需求
        refresh();
      });

      // 初始渲染
      refresh();
    })();
  </script>
</body>
</html>
